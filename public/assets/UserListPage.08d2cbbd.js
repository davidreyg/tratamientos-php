import{W as $,aE as S,aF as U,Y as v,o as d,ak as k,x as b,e as p,w as i,a5 as r,Q as h,a8 as f,f as _,a7 as w,aP as x,aZ as O,aH as B,aG as y,r as P,a2 as u,au as Q,ag as D}from"./index.dc07db66.js";import{U as C}from"./UserApi.7687772d.js";import{_ as N}from"./BaseTable.b7c1a2f2.js";function A(){return $(a=>C.destroy(a))}function F(a){const e=async()=>(await C.fetchAll(a.value)).data(),{data:t,isLoading:s,isSuccess:l,isError:c,isFetching:o,refetch:m}=S([U.USERS,a.value],e,{keepPreviousData:!0});return{data:t,isLoading:s,isSuccess:l,isError:c,isFetching:o,refetch:m}}const T=v({__name:"UsersTableActions",props:{id:{type:String,required:!0}},emits:["destroy","edit"],setup(a){return(e,t)=>(d(),k(O,null,[b((d(),p(w,{clickable:"",onClick:t[0]||(t[0]=s=>e.$emit("edit",a.id))},{default:i(()=>[r(f,{avatar:""},{default:i(()=>[r(h,{name:"fas fa-pen-to-square",color:"warning"})]),_:1}),r(f,null,{default:i(()=>[_("Editar")]),_:1})]),_:1})),[[B]]),r(x),b((d(),p(w,{clickable:"",onClick:t[1]||(t[1]=s=>e.$emit("destroy",a.id))},{default:i(()=>[r(f,{avatar:""},{default:i(()=>[r(h,{name:"fas fa-trash-can",color:"negative"})]),_:1}),r(f,null,{default:i(()=>[_("Eliminar")]),_:1})]),_:1})),[[B]])],64))}}),L=v({__name:"UsersTable",props:{loading:{type:Boolean,required:!1,default:!1},data:{type:Array,required:!0},serverPagination:{type:Object,default:void 0}},emits:["destroyOne","edit"],setup(a,{emit:e}){const t=e,s=[{name:"nombre_completo",align:"left",label:"Nombre",field:"nombre_completo",sortable:!0},{name:"name",align:"center",label:"Usuario",field:"name",sortable:!0},{name:"cargo",align:"center",label:"Cargo",field:"cargo",sortable:!0},{name:"actions",align:"right",label:"",field:"actions"}],{mutateAsync:l}=A(),c=o=>{y.fire({title:"\xBFEst\xE1 seguro de eliminar este registro?",text:"No podra deshacer los cambios!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:async()=>{await l(o,{onSuccess:async()=>{t("destroyOne",o)},onError:()=>{y.hideLoading()}})},allowOutsideClick:()=>!y.isLoading()})};return(o,m)=>(d(),p(N,{columns:s,data:a.data,loading:a.loading,"row-key":"id","server-pagination":a.serverPagination,"show-grid-toggle":!1},{actions:i(({key:n})=>[r(T,{id:n,onEdit:g=>o.$emit("edit",n),onDestroy:g=>c(n)},null,8,["id","onEdit","onDestroy"])]),_:1},8,["data","loading","server-pagination"]))}}),q=v({__name:"UserListPage",setup(a){const e=P({page:1}),{data:t,isFetching:s,isSuccess:l,refetch:c}=F(e),o=()=>{D.success("Registro eliminado correctamente."),c.value()},m=n=>{e.value.page=n.pagination.page,e.value.limit=n.pagination.rowsPerPage,e.value.search=n.filter,e.value.orderBy=n.pagination.sortBy,e.value.sortedBy=n.pagination.descending?"desc":"asc"};return(n,g)=>u(l)&&u(t)?(d(),p(L,{key:0,data:u(t).data,loading:u(s),"server-pagination":u(t).meta.pagination,onEdit:g[0]||(g[0]=E=>n.$router.push({name:"users.edit",params:{id:E}})),onDestroyOne:o,onRequest:m},null,8,["data","loading","server-pagination"])):Q("",!0)}});export{q as default};
