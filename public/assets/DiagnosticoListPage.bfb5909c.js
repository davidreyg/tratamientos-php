import{W as w,aD as y,aE as C,aF as _,Y as D,o as f,e as p,w as u,x as b,a7 as B,a5 as m,Q as x,a8 as h,f as O,aG as g,aH as E,aI as A,r as L,a2 as d,au as N,ag as k}from"./index.dc07db66.js";import{_ as F}from"./BaseTable.b7c1a2f2.js";function Q(){return w(t=>y.delete(t))}function S(t){const n=async()=>(await y.fetchAll(t.value)).data(),{data:o,isLoading:i,isSuccess:r,isError:c,isFetching:l,refetch:e}=C([_.DIAGNOSTICO_ALL,t==null?void 0:t.value],n);return{data:o,isLoading:i,isSuccess:r,isError:c,isFetching:l,refetch:e}}const I=D({__name:"DiagnosticosDataTable",props:{loading:{type:Boolean,required:!1,default:!1},data:{type:Array,required:!0},serverPagination:{type:Object,default:void 0}},emits:["destroyOne","request"],setup(t,{emit:n}){const o=n,{formatDate:i}=A(),r=[{name:"fecha",align:"center",label:"Fecha",field:"created_at",format:e=>i(e)},{name:"enfermedades",align:"left",label:"Enfermedades",field:e=>e.enfermedades.data.map(a=>a.nombre)},{name:"Descripcion",align:"center",label:"Descripcion",field:"observaciones"},{name:"estado",align:"center",label:"Estado",field:"estado"},{name:"actions",align:"center",label:"Acciones",field:"actions"}],{mutateAsync:c}=Q(),l=e=>{g.fire({title:"\xBFEst\xE1 seguro de eliminar este registro?",text:"No podra deshacer los cambios!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:async()=>{await c(Number(e),{onSuccess:async()=>{o("destroyOne",e)},onError:()=>{g.hideLoading()}})},allowOutsideClick:()=>!g.isLoading()})};return(e,a)=>(f(),p(F,{columns:r,data:t.data,loading:t.loading,"row-key":"id","show-grid-toggle":!1,"server-pagination":t.serverPagination,onRequest:a[0]||(a[0]=s=>e.$emit("request",s))},{actions:u(({key:s})=>[b((f(),p(B,{clickable:"",onClick:v=>l(s)},{default:u(()=>[m(h,{avatar:""},{default:u(()=>[m(x,{name:"fas fa-trash-can",color:"negative"})]),_:1}),m(h,null,{default:u(()=>[O("Eliminar")]),_:1})]),_:2},1032,["onClick"])),[[E]])]),_:1},8,["data","loading","server-pagination"]))}}),$=D({__name:"DiagnosticoListPage",setup(t){const n=L({page:1}),{data:o,isFetching:i,isSuccess:r,refetch:c}=S(n),l=()=>{k.success("Registro eliminado correctamente."),c.value()},e=a=>{n.value.page=a.pagination.page,n.value.limit=a.pagination.rowsPerPage,n.value.search=a.filter,n.value.orderBy=a.pagination.sortBy,n.value.sortedBy=a.pagination.descending?"desc":"asc"};return(a,s)=>d(r)&&d(o)?(f(),p(I,{key:0,data:d(o).data,loading:d(i),"server-pagination":d(o).meta.pagination,onEdit:s[0]||(s[0]=v=>a.$router.push({name:"empleados.edit",params:{id:v}})),onDestroyOne:l,onRequest:e},null,8,["data","loading","server-pagination"])):N("",!0)}});export{$ as default};
