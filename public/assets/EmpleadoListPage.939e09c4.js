import{aQ as w,W as k,aE as $,aF as x,Y as C,o as f,e as p,w as s,x as h,a7 as v,a5 as r,Q as y,a8 as g,f as _,aP as A,aG as b,aH as E,r as N,a2 as u,au as O,ag as P}from"./index.5981ee4f.js";import{_ as Q}from"./BaseTable.ee8281dd.js";class D{static async run(a){try{await w.delete(a)}catch(n){throw n}}}class L{static async run(a){try{return(await w.fetchAll({fetchAll:!0,...a})).data()}catch(n){throw n}}}function S(){return k(t=>D.run(t))}function T(t){const a=async()=>await L.run(t.value),{data:n,isLoading:l,isSuccess:c,isError:d,isFetching:e,refetch:i}=$([x.EMPLEADOS_ALL,t==null?void 0:t.value],a,{keepPreviousData:!0});return{data:n,isLoading:l,isSuccess:c,isError:d,isFetching:e,refetch:i}}const F=C({__name:"EmpleadoTable",props:{loading:{type:Boolean,required:!1,default:!1},data:{type:Array,required:!0},serverPagination:{type:Object,default:void 0}},emits:["destroyOne","edit","request"],setup(t,{emit:a}){const n=a,l=[{name:"nombres",align:"left",label:"Nombres",field:e=>`${e.nombres} ${e.apellido_paterno} ${e.apellido_materno}`,sortable:!0},{name:"establecimientos:establecimiento_id|establecimientos.nombre",align:"center",label:"Establecimiento",sortable:!0,field:e=>e.establecimiento.data.nombre},{name:"cargos:cargo_id|cargos.nombre",align:"center",label:"Cargo",sortable:!0,field:e=>e.cargo.data.nombre},{name:"numero_documento",align:"center",label:"N\xB0 de Documento",sortable:!1,field:e=>e.numero_documento},{name:"actions",align:"right",label:"",field:"actions"}],{mutateAsync:c}=S(),d=e=>{b.fire({title:"\xBFEst\xE1 seguro de eliminar este registro?",text:"No podra deshacer los cambios!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:async()=>{await c(Number(e),{onSuccess:async()=>{n("destroyOne",e)},onError:()=>{b.hideLoading()}})},allowOutsideClick:()=>!b.isLoading()})};return(e,i)=>(f(),p(Q,{columns:l,data:t.data,loading:t.loading,"row-key":"id","show-grid-toggle":!1,"server-pagination":t.serverPagination,onRequest:i[0]||(i[0]=o=>e.$emit("request",o))},{actions:s(({key:o})=>[h((f(),p(v,{clickable:"",onClick:m=>e.$emit("edit",o)},{default:s(()=>[r(g,{avatar:""},{default:s(()=>[r(y,{name:"fas fa-pen-to-square",color:"warning"})]),_:1}),r(g,null,{default:s(()=>[_("Editar")]),_:1})]),_:2},1032,["onClick"])),[[E]]),r(A),h((f(),p(v,{clickable:"",onClick:m=>d(o)},{default:s(()=>[r(g,{avatar:""},{default:s(()=>[r(y,{name:"fas fa-trash-can",color:"negative"})]),_:1}),r(g,null,{default:s(()=>[_("Eliminar")]),_:1})]),_:2},1032,["onClick"])),[[E]])]),_:1},8,["data","loading","server-pagination"]))}}),M=C({__name:"EmpleadoListPage",setup(t){const a=N({page:1}),{data:n,isFetching:l,isSuccess:c,refetch:d}=T(a),e=()=>{P.success("Registro eliminado correctamente."),d.value()},i=o=>{a.value.page=o.pagination.page,a.value.limit=o.pagination.rowsPerPage,a.value.search=o.filter,a.value.orderBy=o.pagination.sortBy,a.value.sortedBy=o.pagination.descending?"desc":"asc"};return(o,m)=>u(c)&&u(n)?(f(),p(F,{key:0,data:u(n).data,loading:u(l),"server-pagination":u(n).meta.pagination,onEdit:m[0]||(m[0]=B=>o.$router.push({name:"empleados.edit",params:{id:B}})),onDestroyOne:e,onRequest:i},null,8,["data","loading","server-pagination"])):O("",!0)}});export{M as default};
