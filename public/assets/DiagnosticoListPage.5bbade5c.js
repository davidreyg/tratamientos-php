import{ah as D,a_ as y,a$ as _,d as b,h as g,j as p,v as u,G as B,al as C,x as m,a4 as w,am as h,K as x,b0 as f,b1 as O,e as A,u as d,B as E,ar as L}from"./index.c50cd903.js";import{_ as N}from"./BaseTable.cd4454a3.js";import{u as k}from"./useLuxonFormat.a1b67595.js";import{Q}from"./QueryTypes.707bd378.js";import"./QTable.391fab48.js";import"./QSelect.5f1b5a7b.js";import"./rtl.b51694b1.js";function S(){return D(t=>y.delete(t))}function F(t){const n=async()=>(await y.fetchAll(t.value)).data(),{data:o,isLoading:s,isSuccess:r,isError:c,isFetching:l,refetch:e}=_([Q.DIAGNOSTICO_ALL,t==null?void 0:t.value],n);return{data:o,isLoading:s,isSuccess:r,isError:c,isFetching:l,refetch:e}}const P=b({__name:"DiagnosticosDataTable",props:{loading:{type:Boolean,required:!1,default:!1},data:{type:Array,required:!0},serverPagination:{type:Object,default:void 0}},emits:["destroyOne","request"],setup(t,{emit:n}){const o=n,{formatDate:s}=k(),r=[{name:"fecha",align:"center",label:"Fecha",field:"created_at",format:e=>s(e)},{name:"enfermedades",align:"left",label:"Enfermedades",field:e=>e.enfermedades.data.map(a=>a.nombre)},{name:"Descripcion",align:"center",label:"Descripcion",field:"observaciones"},{name:"estado",align:"center",label:"Estado",field:"estado"},{name:"actions",align:"center",label:"Acciones",field:"actions"}],{mutateAsync:c}=S(),l=e=>{f.fire({title:"\xBFEst\xE1 seguro de eliminar este registro?",text:"No podra deshacer los cambios!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:async()=>{await c(Number(e),{onSuccess:async()=>{o("destroyOne",e)},onError:()=>{f.hideLoading()}})},allowOutsideClick:()=>!f.isLoading()})};return(e,a)=>(g(),p(N,{columns:r,data:t.data,loading:t.loading,"row-key":"id","show-grid-toggle":!1,"server-pagination":t.serverPagination,onRequest:a[0]||(a[0]=i=>e.$emit("request",i))},{actions:u(({key:i})=>[B((g(),p(C,{clickable:"",onClick:v=>l(i)},{default:u(()=>[m(h,{avatar:""},{default:u(()=>[m(w,{name:"fas fa-trash-can",color:"negative"})]),_:1}),m(h,null,{default:u(()=>[x("Eliminar")]),_:1})]),_:2},1032,["onClick"])),[[O]])]),_:1},8,["data","loading","server-pagination"]))}}),M=b({__name:"DiagnosticoListPage",setup(t){const n=A({page:1}),{data:o,isFetching:s,isSuccess:r,refetch:c}=F(n),l=()=>{L.success("Registro eliminado correctamente."),c.value()},e=a=>{n.value.page=a.pagination.page,n.value.limit=a.pagination.rowsPerPage,n.value.search=a.filter,n.value.orderBy=a.pagination.sortBy,n.value.sortedBy=a.pagination.descending?"desc":"asc"};return(a,i)=>d(r)&&d(o)?(g(),p(P,{key:0,data:d(o).data,loading:d(s),"server-pagination":d(o).meta.pagination,onEdit:i[0]||(i[0]=v=>a.$router.push({name:"empleados.edit",params:{id:v}})),onDestroyOne:l,onRequest:e},null,8,["data","loading","server-pagination"])):E("",!0)}});export{M as default};
