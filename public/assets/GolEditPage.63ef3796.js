import{h as S,m as _,q as f,A as c,z as v,u as s,B as l,bq as F,C,aq as b,F as g,ak as B,ar as w}from"./index.8e1e529b.js";import{_ as E}from"./BasePage.2a141dec.js";import{S as L}from"./SkeletonForm.798e33b5.js";import{_ as N}from"./BaseCheckBox.247ce6e4.js";import{u as Q,_ as A,a as V}from"./BaseInput.5767a8ad.js";import{c as x,a as $,d as I}from"./index.esm.4940542b.js";import{a as T,u as U}from"./index.1c9af67c.js";import{G as h}from"./GolApi.f6c0f150.js";import{_ as M}from"./AcademicEntitiesSelect.3eac798b.js";import{Q as O}from"./QueryTypes.b72dec59.js";import"./QPage.29776a48.js";import"./QSkeleton.c3a56f41.js";import"./QField.57308312.js";import"./QSelect.0d489ee9.js";import"./rtl.b51694b1.js";import"./academicEntityFetchAllQuery.2707358f.js";import"./BaseSelect.229e0648.js";class j{static async run(t){try{return(await h.fetchById(t)).data().data}catch(a){throw a}}}class z{static async run(t,a){try{await h.update(t,a)}catch(o){throw o}}}function P(e,t){const a=async()=>await j.run(e),{data:o,isLoading:m,isSuccess:i,isError:u,isFetching:d,refetch:n}=T([O.GOL_ALL,e],a,{enabled:t});return{data:o,isLoading:m,isSuccess:i,isError:u,isFetching:d,refetch:n}}function R(){return U(({data:e,id:t})=>z.run(e,t))}const D=S({__name:"GolEditForm",props:{gol:{type:Object,required:!0}},emits:["submit","cancel"],setup(e,{emit:t}){const a=t,o=e,m=x().shape({name:$().trim().min(10).required().label("Nombre"),is_active:I().required().label("Activo"),academic_entity_id:$().required().label("Escuela")}),{handleSubmit:i,setErrors:u,values:d,setFieldValue:n}=Q({validationSchema:m,initialValues:o.gol}),{isLoading:y,mutate:q}=R(),G=i(async p=>{q({data:p,id:o.gol.id},{onSuccess:async()=>{a("submit")},onError:r=>{r.data.errors&&u(r.data.errors)}})});return(p,r)=>(_(),f(V,{loading:s(y),onSubmit:s(G),onCancel:r[1]||(r[1]=k=>p.$emit("cancel"))},{actions:c(()=>[v(p.$slots,"actions",{isLoading:s(y)})]),default:c(()=>[l(A,{name:"name",label:"Nombre",required:"",class:"col-12"}),l(M,{"academic-entity-id":s(d).academic_entity_id,onFacultyChanged:r[0]||(r[0]=k=>s(n)("academic_entity_id",""))},null,8,["academic-entity-id"]),l(N,{name:"is_active",label:"\xBFActivo?",class:"col-xs-12 col-sm-6"})]),_:3},8,["loading","onSubmit"]))}}),H={class:"row"},ut=S({__name:"GolEditPage",props:{id:{type:String,required:!0}},setup(e){const t=e,a=F(),{data:o,isSuccess:m,isFetching:i}=P(t.id,!0),u=()=>{w.success("Gol registrado correctamente"),a.back()};return(d,n)=>(_(),f(E,{loading:!1,title:"Editar Gol"},{content:c(()=>[C("div",H,[s(i)?(_(),f(b,{key:0,class:"col-6 q-pa-lg"},{default:c(()=>[l(L,{class:"col-12"})]),_:1})):g("",!0),s(m)&&!s(i)&&s(o)?(_(),f(b,{key:1,class:"my-card col-xs-12 col-sm-8 col-md-6 q-pa-md"},{default:c(()=>[l(B,null,{default:c(()=>[l(D,{gol:s(o),onSubmit:u,onCancel:n[0]||(n[0]=y=>d.$router.back())},null,8,["gol"])]),_:1})]),_:1})):g("",!0)])]),_:1}))}});export{ut as default};
