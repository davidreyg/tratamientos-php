var R=Object.defineProperty;var I=(a,e,s)=>e in a?R(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;var T=(a,e,s)=>(I(a,typeof e!="symbol"?e+"":e,s),s);import{a as O,aE as G,aF as U,Y as F,a1 as V,o as u,e as v,w as m,ak as g,a_ as w,ad as C,aZ as k,a2 as f,aa as z,r as y,H as B,b6 as H,b7 as Y,$ as S,b8 as Z,au as P,b9 as J,aS as A,a5 as r,f as Q,am as j,al as K,ba as D,bb as M,aR as W,k as X,a0 as ee,aG as E,bc as ae,aU as te,ab as se,ac as ne,bd as oe,aj as ie,be as re,bf as N}from"./index.2f4e1c46.js";const $=class{static async fetchAll(e){return await $._api.get($._endpoint,e)}};let x=$;T(x,"_api",O),T(x,"_endpoint","/signos");function le(a){const e=async()=>(await x.fetchAll(a==null?void 0:a.value)).data().data,{data:s,isLoading:o,isSuccess:l,isError:i,isFetching:d,refetch:t}=G([U.SIGNO_ALL],e);return{data:s,isLoading:o,isSuccess:l,isError:i,isFetching:d,refetch:t}}const ce=F({__name:"FormDinamico",props:{fields:{type:Array,required:!0},initialValues:{type:Object,required:!1,default:void 0},validationSchema:{type:Object,required:!0}},emits:["submit"],setup(a){const e=a,{handleSubmit:s,values:o}=V({validationSchema:e.validationSchema,initialValues:e.initialValues}),l=s(async i=>{console.log(i)},i=>{console.log(i)});return(i,d)=>(u(),v(z,{onSubmit:f(l)},{default:m(()=>[(u(!0),g(k,null,w(a.fields.filter(t=>t.type!=="array"),(t,p)=>(u(),v(C,{key:p,name:t.name,label:t.label,suffix:t.suffix,"stack-label":!0,class:"col-xs-12 col-sm-4"},null,8,["name","label","suffix"]))),128)),(u(!0),g(k,null,w(a.fields.filter(t=>t.type==="array"),(t,p)=>(u(),g("div",{key:p,class:"col-12 row q-col-gutter-md"},[(u(!0),g(k,null,w(t.fields,(b,h)=>(u(),v(C,{key:h,name:`signos[${h}].valor`,label:b.label,suffix:b.suffix,"stack-label":!0,class:"col-xs-12 col-sm-4"},null,8,["name","label","suffix"]))),128))]))),128))]),_:1},8,["onSubmit"]))}}),ue=F({__name:"TriajeCreateForm",props:{pacienteId:{type:Number,required:!0}},emits:["submit"],setup(a){const e=y({search:"estado:1"}),{data:s}=le(e),o=y([]),l=y(),i=y();return B(()=>s.value,d=>{if(d){const t=d.map(n=>({label:n.nombre,name:n.nombre,type:"number",suffix:n.unidad}));o.value=[{name:"fecha_registro",label:"Fecha Registro",type:"string"},{name:"signos",label:"Signos",type:"array",fields:t}];const p=H().of(Y(n=>{const _=d.find(c=>c.id==n.id);let q={};return _&&(q={id:J().when([],{is:()=>_.is_required,then:c=>c.required(),otherwise:c=>c.optional()}).label("Id del signo"),valor:A().positive().when([],{is:()=>_.is_required,then:c=>c.required(),otherwise:c=>c.optional()}).transform((c,L)=>L===""?void 0:c).typeError("Debe ingresar un numero").label(_.nombre)}),S().shape(q)})),b=S().shape({fecha_registro:Z().required().label("Fecha Registro")}).required();l.value=b.concat(S().shape({signos:p}));const h=d.map(n=>({id:n.id,valor:void 0}));i.value={fecha_registro:"1998",signos:h}}},{immediate:!0}),(d,t)=>o.value.length>0&&l.value?(u(),v(ce,{key:0,fields:o.value,"validation-schema":l.value,"initial-values":i.value},null,8,["fields","validation-schema","initial-values"])):P("",!0)}}),de=F({__name:"TriajeTab",setup(a){const e=y("new");return(s,o)=>(u(),v(K,{modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=l=>e.value=l),animated:"",class:""},{default:m(()=>[r(j,{name:"list"},{default:m(()=>[Q(" list ")]),_:1}),r(j,{name:"new"},{default:m(()=>[r(ue,{"paciente-id":2})]),_:1}),r(j,{name:"edit"},{default:m(()=>[Q(" editar ")]),_:1})]),_:1},8,["modelValue"]))}}),me={class:"row q-col-gutter-md"},fe={class:"col-12"},be=F({__name:"TriajeRegistroPage",setup(a){const{fetchPaciente:e,$reset:s}=D(),{paciente:o,isPacienteLoading:l}=M(D()),{data:i}=W(),d=X(()=>i.value?i.value.map(n=>({label:n.nombre,value:n.id})):[]),t=S().shape({numero_documento:A().typeError("Debe ingresar un n\xFAmero").min(8).required().label("N\xFAmero de Documento"),tipo_documento_id:ee().required().label("Tipo de Documento")}),{handleSubmit:p,values:b}=V({validationSchema:t}),h=p(async n=>{await e(n.numero_documento),o.value?E.fire({title:"Exito!",text:"Paciente encontrado correctamente!",icon:"success"}):E.fire({title:"Informaci\xF3n!",text:"No se encontro el paciente indicado!",icon:"info"})});return ae(()=>{s()}),B(()=>o.value,n=>{n&&console.log("hay paciente, debeiramos buscar su triaje")}),(n,_)=>(u(),g("div",me,[r(oe,{class:"col-12 row q-col-gutter-lg items-start justify-center",onSubmit:f(h)},{default:m(()=>[r(te,{options:d.value,name:"tipo_documento_id",class:"col-xs-12 col-sm-4",label:"Tipo de Documento",loading:!1,required:""},null,8,["options"]),r(C,{name:"numero_documento",label:"N\xB0 de Documento",class:"col-xs-12 col-sm-4",required:""}),r(se,{class:"col-auto justify-center"},{default:m(()=>[r(ne,{color:"primary",outline:"",size:"lg",icon:"search",label:"Buscar","no-caps":"",type:"submit",loading:f(l)},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"]),ie("div",fe,[r(N,{icon:"fas fa-person",label:"Datos del Paciente",caption:"Editar / Crear"},{default:m(()=>[r(re,{paciente:f(o),onCancel:f(s),onSubmit:_[0]||(_[0]=q=>f(e)(f(b).numero_documento))},null,8,["paciente","onCancel"])]),_:1}),f(o)?(u(),v(N,{key:0,icon:"fas fa-stethoscope",label:"Triaje",caption:"Editar / Crear"},{default:m(()=>[r(de)]),_:1})):P("",!0)])]))}});export{be as default};
