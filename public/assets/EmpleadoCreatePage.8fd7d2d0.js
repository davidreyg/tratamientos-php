import{aG as Q,a6 as L,a8 as h,aU as P,h as m,aa as I,ab as i,aV as b,ac as R,ar as U,aW as G,E as O,o as v,e as x,w as d,ag as a,aX as _,an as W,ad as f,aY as X,f as Y,aE as Z,ao as s,au as j,aZ as z,a_ as H,al as J,a$ as K,b0 as ee}from"./index.92769849.js";import{u as ae,a as oe}from"./establecimientoFetchAllQuery.12dfce83.js";class le{static async run(t){try{await Q.create(t)}catch(l){throw l}}}function ne(){return L(c=>le.run(c))}const re={class:"col-xs-12 col-sm-4"},se=h({__name:"EmpleadoCreateForm",emits:["submit","cancel"],setup(c,{emit:t}){const l=t,{data:u}=P(),E=m(()=>u.value?u.value.map(e=>({label:e.nombre,value:e.id})):[]),{data:g}=ae(),N=m(()=>g.value?g.value.map(e=>({label:e.nombre,value:e.id})):[]),{data:q}=oe(),F=m(()=>q.value?q.value.map(e=>({label:e.nombre,value:e.id})):[]),$=m(()=>{const e=E.value.find(o=>o.value==Number(p.tipo_documento_id));return e?e.label==="DNI":!1}),y=I().shape({nombres:i().trim().required().label("Nombres"),apellido_paterno:i().trim().required().label("Apellido Paterno"),apellido_materno:i().trim().required().label("Apellido Materno"),tipo_documento_id:i().required().label("Tipo de Documento"),numero_documento:b().typeError("Debe ingresar un n\xFAmero").required().label("N\xFAmero de Documento"),fecha_nacimiento:i().trim().required().label("Fecha de Nacimiento"),telefono:b().typeError("Tel\xE9fono debe ser un numero").integer().positive().required().label("Tel\xE9fono"),edad:b().typeError("Edad debe ser un numero").integer().positive().required().label("Edad"),sexo:i().required().label("Sexo")}),{handleSubmit:C,setErrors:S,values:p,setFieldValue:n,resetForm:A}=R({validationSchema:y}),{isLoading:T,mutate:D}=ne(),k=C(async e=>{D(e,{onSuccess:()=>{U.success(),l("submit")},onError:o=>{S(o.data.errors)}})},e=>console.log(e)),{fetch:M,reniec:r,isLoading:V}=G(),w=async()=>{if(await M(p.numero_documento),r.value){n("nombres",r.value.nombres),n("apellido_paterno",r.value.apellido_paterno),n("apellido_materno",r.value.apellido_materno),n("direccion",r.value.direccion),n("sexo",r.value.sexo==="1"?"Masculino":"Femenino");var e=r.value.fecha_nacimiento.split("/");const o=K.local(Number(e[2]),Number(e[1]),Number(e[0]));o.isValid&&n("fecha_nacimiento",o.toISODate())}else A()},{calcularEdad:B}=ee();return O(()=>p.fecha_nacimiento,e=>{e&&n("edad",B(e))}),(e,o)=>(v(),x(J,{loading:f(T),onSubmit:f(k),onCancel:o[0]||(o[0]=te=>e.$emit("cancel"))},{default:d(()=>[a(_,{options:E.value,name:"tipo_documento_id",class:"col-xs-12 col-sm-4",label:"Tipo de Documento",loading:!1,required:""},null,8,["options"]),a(s,{name:"numero_documento",label:"N\xB0 de Documento",class:"col-xs-12 col-sm-4",required:""},{after:d(()=>[$.value?(v(),x(W,{key:0,round:"",dense:"",icon:"search",color:"primary",loading:f(V),onClick:w},{default:d(()=>[a(X,null,{default:d(()=>[Y(" Buscar en RENIEC ")]),_:1})]),_:1},8,["loading"])):Z("",!0)]),_:1}),a(_,{options:N.value,name:"establecimiento_id",class:"col-xs-12 col-sm-4",label:"Establecimiento",loading:!1,required:""},null,8,["options"]),a(_,{options:F.value,name:"cargo_id",class:"col-xs-12 col-sm-4",label:"Cargo",loading:!1,required:""},null,8,["options"]),a(s,{name:"nombres",label:"Nombres",class:"col-xs-12 col-sm-4",required:""}),a(s,{name:"apellido_paterno",label:"Apellido Paterno",class:"col-xs-12 col-sm-4",required:""}),a(s,{name:"apellido_materno",label:"Apellido Materno",class:"col-xs-12 col-sm-4",required:""}),j("div",re,[a(z,{required:"",name:"fecha_nacimiento",label:"Fecha Nacimiento"})]),a(s,{name:"direccion",label:"Direcci\xF3n",class:"col-xs-12 col-sm-4",required:""}),a(s,{name:"telefono",label:"Tel\xE9fono",class:"col-xs-12 col-sm-4",required:""}),a(s,{name:"edad",label:"Edad",class:"col-xs-12 col-sm-4",required:""}),a(H,{required:"",options:[{label:"Masculino",value:"Masculino"},{label:"Femenino",value:"Femenino"}],name:"sexo",label:"Sexo",class:"col-xs-12 col-sm-8"})]),_:1},8,["loading","onSubmit"]))}}),ue=h({__name:"EmpleadoCreatePage",setup(c){return(t,l)=>(v(),x(se,{onSubmit:l[0]||(l[0]=u=>t.$router.back()),onCancel:l[1]||(l[1]=u=>t.$router.back())}))}});export{ue as default};
