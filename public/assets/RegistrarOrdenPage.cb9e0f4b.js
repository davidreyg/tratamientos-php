var W=Object.defineProperty;var Y=(o,a,i)=>a in o?W(o,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[a]=i;var F=(o,a,i)=>(Y(o,typeof a!="symbol"?a+"":a,i),i);import{a as J,W as K,Y as T,k as D,$ as O,a0 as m,a$ as I,aS as $,a1 as M,r as E,ag as X,H as Z,o as v,e as h,w as s,a5 as e,ad as p,aU as R,aV as B,f as y,ac as Q,aj as g,aP as ee,a2 as c,aa as ae,am as k,al as te,au as G,b0 as oe,b1 as ie,b2 as se,aR as ne,aG as V,b3 as re,ak as le,ab as ce,b4 as ue,b5 as de,b6 as L}from"./index.0ca9fa93.js";import{u as me}from"./establecimientoFetchAllQuery.05669872.js";import{u as pe}from"./paqueteFetchAllQuery.9c46826e.js";import{_ as _e}from"./ExamenCardList.bb11f044.js";import{_ as be}from"./BaseCheckBoxGroup.e5ea79c8.js";import"./PaqueteApi.c06dc5c6.js";const f=class{static fetchAll(a){return f._api.get(`${f._endpoint}`,a)}static async create(a){await f._api.post(f._endpoint,a)}};let x=f;F(x,"_api",J),F(x,"_endpoint","/ordens");function fe(){return K(o=>x.create(o))}const ve={class:"col-12"},ge={class:"col-12"},qe={class:"col-12 row q-col-gutter-sm"},xe=T({__name:"OrdenCreateForm",props:{pacienteId:{type:Number,required:!0}},setup(o){const a=o,{data:i}=pe(),l=D(()=>i.value?i.value.map(t=>({label:t.nombre,value:Number(t.id)})):[]),{data:_}=me(),b=D(()=>_.value?_.value.map(t=>({label:t.nombre,value:Number(t.id)})):[]),q=O().shape({diagnostico:m().trim().min(2).required().label("Diagnostico"),CI10:m().trim().min(2).required().label("CI10"),CPN:m().trim().min(2).required().label("CPN"),EG:m().trim().min(2).required().label("EG"),codigo_atencion:m().trim().min(2).required().label("Codigo de Atencion"),fecha_registro:m().trim().required().label("Fecha de Registro"),medico:m().trim().required().label("M\xE9dico"),examen_ids:I().of($().required()).required().label("Examenes"),paquete_ids:I().of($().required()).required().label("Paquetes"),establecimiento_id:$().when([],{is:()=>n.value,then:t=>t.required(),otherwise:t=>t.optional()}).label("Establecimiento Institucional"),establecimiento_otro:m().when([],{is:()=>!n.value,then:t=>t.required(),otherwise:t=>t.optional()}).label("Otro Establecimiento")}),{values:P,setFieldValue:C,handleSubmit:N}=M({validationSchema:q,initialValues:{examen_ids:[],paquete_ids:[],paciente_id:a.pacienteId}}),n=E(!0),{mutateAsync:w,reset:S,isLoading:U}=fe(),j=N(async(t,{setErrors:r,resetForm:u})=>{await w(t,{onSuccess:()=>{X.success("Orden registrada correctamente."),u()},onError:d=>{S.value(),r(d.data.errors)}})});Z(()=>P.examen_ids,t=>{var r;if(t){const u=(r=i.value)==null?void 0:r.filter(d=>d.examen_ids.every(H=>t.includes(H)));C("paquete_ids",(u==null?void 0:u.map(d=>Number(d.id)))||[])}});const z=t=>{var r;if(t){const u=(r=i.value)==null?void 0:r.filter(d=>t.includes(Number(d.id))).map(d=>d.examen_ids).flat();C("examen_ids",[...new Set(u)])}};return(t,r)=>(v(),h(ae,{loading:c(U),onSubmit:c(j)},{default:s(()=>[e(p,{name:"medico",label:"Medico",class:"col-xs-12 col-sm-6",required:""}),n.value?(v(),h(R,{key:0,options:b.value,name:"establecimiento_id",class:"col-xs-12 col-sm-6",label:"Establecimiento Institucional",loading:!1,required:""},{after:s(()=>[e(Q,{round:"",flat:"",icon:"fas fa-building-circle-arrow-right",color:"primary",onClick:r[0]||(r[0]=u=>n.value=!1)},{default:s(()=>[e(B,null,{default:s(()=>[y(" Otro establecimiento ")]),_:1})]),_:1})]),_:1},8,["options"])):(v(),h(p,{key:1,name:"establecimiento_otro",label:"Otro establecimiento",class:"col-xs-12 col-sm-6",required:""},{after:s(()=>[e(Q,{round:"",flat:"",icon:"fas fa-building-circle-xmark",color:"negative",onClick:r[1]||(r[1]=u=>n.value=!0)},{default:s(()=>[e(B,null,{default:s(()=>[y(" Establecimiento institucional")]),_:1})]),_:1})]),_:1})),e(p,{name:"diagnostico",label:"Diagnostico",class:"col-xs-12 col-sm-4",required:""}),e(p,{name:"CI10",label:"CI10",class:"col-xs-12 col-sm-4",required:""}),e(p,{name:"CPN",label:"CPN",class:"col-xs-12 col-sm-4",required:""}),e(p,{name:"EG",label:"EG",class:"col-xs-12 col-sm-4",required:""}),e(p,{name:"codigo_atencion",label:"Codigo de Atenci\xF3n",class:"col-xs-12 col-sm-4",required:""}),e(p,{name:"fecha_registro",label:"Fecha de Registro",class:"col-xs-12 col-sm-4",type:"date",required:""}),g("div",ve,[e(ee,{spaced:""}),y(" Paquetes")]),g("div",ge,[e(be,{name:"paquete_ids",label:"Paquetes",options:l.value,onUpdate:z},null,8,["options"])]),g("div",qe,[e(_e)])]),_:1},8,["loading","onSubmit"]))}}),he=g("div",{class:"text-h6"},"Mails",-1),ye=g("div",{class:"text-h6"},"Movies",-1),Ce=T({__name:"DatosOrdenTab",props:{paciente:{type:Object,required:!0}},setup(o){const a=E("new");return(i,l)=>o.paciente?(v(),h(te,{key:0,modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=_=>a.value=_),animated:""},{default:s(()=>[e(k,{name:"mails"},{default:s(()=>[he,y(" Lorem ipsum dolor sit amet consectetur adipisicing elit. ")]),_:1}),e(k,{name:"new"},{default:s(()=>[e(xe,{"paciente-id":Number(o.paciente.id)},null,8,["paciente-id"])]),_:1}),e(k,{name:"movies"},{default:s(()=>[ye,y(" Lorem ipsum dolor sit amet consectetur adipisicing elit. ")]),_:1})]),_:1},8,["modelValue"])):G("",!0)}}),A=oe("laboratorio-form",()=>{const o=E(),a=E(!1);function i(){o.value=void 0}function l(b){o.value=b}async function _(b){a.value=!0;try{o.value=void 0,o.value=await ie.run(b),a.value=!1}catch(q){throw a.value=!1,q}}return{paciente:o,isPacienteLoading:a,$reset:i,setPaciente:l,fetchPaciente:_}}),we={class:"row q-col-gutter-md"},$e={class:"col-12"},Qe=T({__name:"RegistrarOrdenPage",setup(o){const{fetchPaciente:a,$reset:i}=A(),{paciente:l,isPacienteLoading:_}=se(A()),{data:b}=ne(),q=D(()=>b.value?b.value.map(n=>({label:n.nombre,value:n.id})):[]),P=O().shape({numero_documento:$().typeError("Debe ingresar un n\xFAmero").min(8).required().label("N\xFAmero de Documento"),tipo_documento_id:m().required().label("Tipo de Documento")}),{handleSubmit:C}=M({validationSchema:P}),N=C(async n=>{await a(n.numero_documento),l.value?V.fire({title:"Exito!",text:"Paciente encontrado correctamente!",icon:"success"}):V.fire({title:"Informaci\xF3n!",text:"No se encontro el paciente indicado!",icon:"info"})});return re(()=>{if(window.confirm("Esta seguro de salir? Tiene cambios sin guardar!"))i();else return!1}),(n,w)=>(v(),le("div",we,[e(ue,{class:"col-12 row q-col-gutter-lg items-start justify-center",onSubmit:c(N)},{default:s(()=>[e(R,{options:q.value,name:"tipo_documento_id",class:"col-xs-12 col-sm-4",label:"Tipo de Documento",loading:!1,required:""},null,8,["options"]),e(p,{name:"numero_documento",label:"N\xB0 de Documento",class:"col-xs-12 col-sm-4",required:""}),e(ce,{class:"col-auto justify-center"},{default:s(()=>[e(Q,{color:"primary",outline:"",size:"lg",icon:"search",label:"Buscar","no-caps":"",type:"submit",loading:c(_)},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"]),g("div",$e,[e(L,{icon:"fas fa-person",label:"Datos del Paciente",caption:"Editar / Crear",class:"bg-purple-2"},{default:s(()=>[e(de,{class:"bg-purple-1",paciente:c(l),onCancel:c(i),onSubmit:w[0]||(w[0]=S=>c(a)(S))},null,8,["paciente","onCancel"])]),_:1}),c(l)?(v(),h(L,{key:0,icon:"fas fa-vials",label:"Datos de la Orden de Lab.",caption:"Editar / Crear"},{default:s(()=>[e(Ce,{paciente:c(l),onCancel:c(i)},null,8,["paciente","onCancel"])]),_:1})):G("",!0)])]))}});export{Qe as default};
