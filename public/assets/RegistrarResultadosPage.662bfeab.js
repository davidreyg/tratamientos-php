import{W as I,Y as $,ba as F,r as c,bb as P,H as A,o as l,ak as q,aj as z,a5 as a,w as e,am as y,a2 as t,e as d,ac as C,aY as k,f as b,au as u,ae as p,a6 as h,bi as B,al as D,aG as m,ag as G}from"./index.d3351ac8.js";import{_ as M,a as U}from"./RegistrarResultadosForm.b0d7d2f5.js";import{u as Y,_ as j}from"./OrdenTable.32161b6e.js";import{O as H}from"./OrdenApi.7314d47a.js";import{u as O}from"./laboratorio.store.0f5d1413.js";import"./operadoresFetchAllQuery.5efdb89b.js";import"./UnidadApi.53af3e20.js";import"./BaseCheckBox.66f0cda5.js";import"./BaseTable.222b14d4.js";function J(){return I(f=>H.registrar(f))}const W={class:"row q-col-gutter-md"},K={class:"col-12"},le=$({__name:"RegistrarResultadosPage",setup(f){const{$reset:w,fetchOrdenById:x}=O(),{ordenSeleccionada:s,isOrdenLoading:N}=F(O()),R=c({search:"estado:0",searchJoin:"and",limit:0}),i=c(),{data:_,refetch:E}=Y(R),r=c("list"),L=async o=>{i.value=o,await x(o),s.value&&(r.value="edit-examens")},{mutateAsync:Q,isLoading:S}=J(),T=async o=>{i.value=o,m.fire({title:"\xBFEst\xE1 seguro de culminar el REGISTRO de los resultados?",text:"No podra deshacer los cambios!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:async()=>{await Q(o,{onSuccess:async()=>{G.success("La orden se VERIFICO correctamente."),E.value(),r.value="list"},onError:()=>{m.hideLoading()}})},allowOutsideClick:()=>!m.isLoading()})},g=()=>{s.value=void 0};return P(()=>{w()}),A(()=>s.value,o=>{o||(r.value="list")}),(o,v)=>(l(),q("div",W,[z("div",K,[a(D,{modelValue:r.value,"onUpdate:modelValue":v[0]||(v[0]=n=>r.value=n),animated:""},{default:e(()=>[a(y,{name:"list"},{default:e(()=>[t(_)?(l(),d(j,{key:0,ordens:t(_).data},{"custom-actions":e(({props:n})=>[a(C,{color:"primary",icon:"fas fa-file-signature",round:"",flat:"",size:"sm",loading:t(N)&&i.value===Number(n.key),onClick:V=>L(Number(n.key))},{default:e(()=>[a(k,null,{default:e(()=>[b("Editar resultados.")]),_:1})]),_:2},1032,["loading","onClick"]),n.row.estado===0?(l(),d(C,{key:0,color:"info",icon:"fas fa-check-double",round:"",flat:"",size:"sm",loading:t(S)&&i.value===Number(n.key),onClick:V=>T(Number(n.key))},{default:e(()=>[a(k,null,{default:e(()=>[b("Confirmar registro.")]),_:1})]),_:2},1032,["loading","onClick"])):u("",!0)]),_:1},8,["ordens"])):u("",!0)]),_:1}),a(y,{name:"edit-examens"},{default:e(()=>[t(s)?(l(),d(B,{key:0,icon:"fas fa-file-signature",label:"Datos de la orden."},{default:e(()=>[a(p,{class:"my-card"},{default:e(()=>[a(h,null,{default:e(()=>[a(M,{orden:t(s)},null,8,["orden"])]),_:1})]),_:1})]),_:1})):u("",!0),t(s)?(l(),d(B,{key:1,icon:"fas fa-vials",label:"Registrar resultados.",caption:"Editar / Crear","default-opened":""},{default:e(()=>[a(p,{class:"my-card"},{default:e(()=>[a(h,null,{default:e(()=>[a(U,{orden:t(s),onCancel:g,onSubmit:g},null,8,["orden"])]),_:1})]),_:1})]),_:1})):u("",!0)]),_:1})]),_:1},8,["modelValue"])])]))}});export{le as default};
