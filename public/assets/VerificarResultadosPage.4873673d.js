import{U as R,X as $,b8 as A,r as u,b9 as P,G as U,o as r,aj as C,ai as q,a4 as a,w as e,al as k,a1 as n,d as l,ab as b,aX as g,e as p,at as c,ad as h,a5 as w,bg as B,ak as z,aF as f,af as D}from"./index.0b61b42a.js";import{_ as M,a as X}from"./RegistrarResultadosForm.137aea14.js";import{u as j,_ as G}from"./OrdenTable.5c4c2dc2.js";import{O as J}from"./OrdenApi.505fed1e.js";import{u as O}from"./laboratorio.store.71330ff7.js";import"./operadoresFetchAllQuery.2318cb1a.js";import"./UnidadApi.48fefe35.js";import"./BaseCheckBox.6b28d6ca.js";import"./BaseTable.15a0ffee.js";function H(){return R(m=>J.verificar(m))}const K={class:"row q-col-gutter-md"},W={class:"col-12"},Y={key:2},le=$({__name:"VerificarResultadosPage",setup(m){const{$reset:V,fetchOrdenById:x}=O(),{ordenSeleccionada:s,isOrdenLoading:N}=A(O()),E=u({search:"estado:1",searchJoin:"and",limit:0}),d=u(),{data:_,refetch:I}=j(E),i=u("list"),L=async o=>{d.value=o,await x(o),s.value&&(i.value="edit-examens")},{mutateAsync:Q,isLoading:S}=H(),T=async o=>{d.value=o,f.fire({title:"\xBFEst\xE1 seguro de culminar la VERIFICACION?",text:"No podra deshacer los cambios!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:async()=>{await Q(o,{onSuccess:async()=>{D.success("La orden se VERIFICO correctamente."),I.value(),i.value="list"},onError:()=>{f.hideLoading()}})},allowOutsideClick:()=>!f.isLoading()})},v=()=>{s.value=void 0};return P(()=>{V()}),U(()=>s.value,o=>{o||(i.value="list")}),(o,y)=>(r(),C("div",K,[q("div",W,[a(z,{modelValue:i.value,"onUpdate:modelValue":y[0]||(y[0]=t=>i.value=t),animated:""},{default:e(()=>[a(k,{name:"list"},{default:e(()=>[n(_)?(r(),l(G,{key:0,ordens:n(_).data},{"custom-actions":e(({props:t})=>[t.row.estado!==2?(r(),l(b,{key:0,color:"primary",icon:"fas fa-file-signature",round:"",flat:"",size:"sm",loading:n(N)&&d.value===Number(t.key),onClick:F=>L(Number(t.key))},{default:e(()=>[a(g,null,{default:e(()=>[p("Editar resultados.")]),_:1})]),_:2},1032,["loading","onClick"])):c("",!0),t.row.estado===1?(r(),l(b,{key:1,color:"positive",icon:"fas fa-thumbs-up",round:"",flat:"",size:"sm",loading:n(S)&&d.value===Number(t.key),onClick:F=>T(Number(t.key))},{default:e(()=>[a(g,null,{default:e(()=>[p("Verificar orden.")]),_:1})]),_:2},1032,["loading","onClick"])):(r(),C("div",Y))]),_:1},8,["ordens"])):c("",!0)]),_:1}),a(k,{name:"edit-examens"},{default:e(()=>[n(s)?(r(),l(B,{key:0,icon:"fas fa-file-signature",label:"Datos de la orden."},{default:e(()=>[a(h,{class:"my-card"},{default:e(()=>[a(w,null,{default:e(()=>[a(M,{orden:n(s)},null,8,["orden"])]),_:1})]),_:1})]),_:1})):c("",!0),n(s)?(r(),l(B,{key:1,icon:"fas fa-vials",label:"Registrar resultados.",caption:"Editar / Crear","default-opened":""},{default:e(()=>[a(h,{class:"my-card"},{default:e(()=>[a(w,null,{default:e(()=>[a(X,{orden:n(s),"with-observaciones":"",onCancel:v,onSubmit:v},null,8,["orden"])]),_:1})]),_:1})]),_:1})):c("",!0)]),_:1})]),_:1},8,["modelValue"])])]))}});export{le as default};
