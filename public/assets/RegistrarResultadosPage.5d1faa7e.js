import{W as T,Y as $,b1 as I,r as f,b2 as P,H as A,o as l,ak as q,aj as z,a5 as a,w as e,am as v,a2 as s,e as u,ac as y,aX as k,f as b,au as c,ae as C,a6 as p,b5 as O,al as D,ag as F}from"./index.cab78154.js";import{u as M,_ as U,a as j,b as G}from"./OrdenTable.d8224a32.js";import{O as H,u as h}from"./laboratorio.store.ac157cd8.js";import"./BaseTable.35738929.js";function J(){return T(m=>H.registrar(m))}const W={class:"row q-col-gutter-md"},X={class:"col-12"},ae=$({__name:"RegistrarResultadosPage",setup(m){const{$reset:N,fetchOrdenById:R}=h(),{ordenSeleccionada:o,isOrdenLoading:Q}=I(h()),w=f({search:"estado:0",searchJoin:"and",limit:0}),d=f(),{data:_,refetch:x}=M(w),r=f("list"),B=async t=>{d.value=t,await R(t),o.value&&(r.value="edit-examens")},{mutateAsync:V,isLoading:E}=J(),L=async t=>{d.value=t,await V(t,{onSuccess:()=>{F.success("La orden se REGISTRO correctamente."),x.value(),r.value="list"},onError:i=>{console.log(i)}})},g=()=>{o.value=void 0};return P(()=>{N()}),A(()=>o.value,t=>{t||(r.value="list")}),(t,i)=>(l(),q("div",W,[z("div",X,[a(D,{modelValue:r.value,"onUpdate:modelValue":i[0]||(i[0]=n=>r.value=n),animated:""},{default:e(()=>[a(v,{name:"list"},{default:e(()=>[s(_)?(l(),u(U,{key:0,ordens:s(_).data},{"custom-actions":e(({props:n})=>[a(y,{color:"primary",icon:"fas fa-file-signature",round:"",flat:"",size:"sm",loading:s(Q)&&d.value===Number(n.key),onClick:S=>B(Number(n.key))},{default:e(()=>[a(k,null,{default:e(()=>[b("Editar resultados.")]),_:1})]),_:2},1032,["loading","onClick"]),n.row.estado===0?(l(),u(y,{key:0,color:"info",icon:"fas fa-check-double",round:"",flat:"",size:"sm",loading:s(E)&&d.value===Number(n.key),onClick:S=>L(Number(n.key))},{default:e(()=>[a(k,null,{default:e(()=>[b("Confirmar registro.")]),_:1})]),_:2},1032,["loading","onClick"])):c("",!0)]),_:1},8,["ordens"])):c("",!0)]),_:1}),a(v,{name:"edit-examens"},{default:e(()=>[s(o)?(l(),u(O,{key:0,icon:"fas fa-file-signature",label:"Datos de la orden."},{default:e(()=>[a(C,{class:"my-card"},{default:e(()=>[a(p,null,{default:e(()=>[a(j,{orden:s(o)},null,8,["orden"])]),_:1})]),_:1})]),_:1})):c("",!0),s(o)?(l(),u(O,{key:1,icon:"fas fa-vials",label:"Registrar resultados.",caption:"Editar / Crear","default-opened":""},{default:e(()=>[a(C,{class:"my-card"},{default:e(()=>[a(p,null,{default:e(()=>[a(G,{orden:s(o),onCancel:g,onSubmit:g},null,8,["orden"])]),_:1})]),_:1})]),_:1})):c("",!0)]),_:1})]),_:1},8,["modelValue"])])]))}});export{ae as default};
