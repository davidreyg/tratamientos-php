import{U as I,X as $,b8 as F,r as c,b9 as P,G as A,o as l,aj as U,ai as q,a4 as a,w as e,al as y,a1 as t,d,ab as C,aX as k,e as b,at as u,ad as p,a5 as h,bg as B,ak as z,aF as f,af as D}from"./index.0b61b42a.js";import{_ as G,a as M}from"./RegistrarResultadosForm.137aea14.js";import{u as X,_ as j}from"./OrdenTable.5c4c2dc2.js";import{O as J}from"./OrdenApi.505fed1e.js";import{u as O}from"./laboratorio.store.71330ff7.js";import"./operadoresFetchAllQuery.2318cb1a.js";import"./UnidadApi.48fefe35.js";import"./BaseCheckBox.6b28d6ca.js";import"./BaseTable.15a0ffee.js";function H(){return I(m=>J.registrar(m))}const K={class:"row q-col-gutter-md"},W={class:"col-12"},le=$({__name:"RegistrarResultadosPage",setup(m){const{$reset:w,fetchOrdenById:x}=O(),{ordenSeleccionada:s,isOrdenLoading:N}=F(O()),R=c({search:"estado:0",searchJoin:"and",limit:0}),i=c(),{data:_,refetch:E}=X(R),r=c("list"),L=async o=>{i.value=o,await x(o),s.value&&(r.value="edit-examens")},{mutateAsync:Q,isLoading:S}=H(),T=async o=>{i.value=o,f.fire({title:"\xBFEst\xE1 seguro de culminar el REGISTRO de los resultados?",text:"No podra deshacer los cambios!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:async()=>{await Q(o,{onSuccess:async()=>{D.success("La orden se VERIFICO correctamente."),E.value(),r.value="list"},onError:()=>{f.hideLoading()}})},allowOutsideClick:()=>!f.isLoading()})},g=()=>{s.value=void 0};return P(()=>{w()}),A(()=>s.value,o=>{o||(r.value="list")}),(o,v)=>(l(),U("div",K,[q("div",W,[a(z,{modelValue:r.value,"onUpdate:modelValue":v[0]||(v[0]=n=>r.value=n),animated:""},{default:e(()=>[a(y,{name:"list"},{default:e(()=>[t(_)?(l(),d(j,{key:0,ordens:t(_).data},{"custom-actions":e(({props:n})=>[a(C,{color:"primary",icon:"fas fa-file-signature",round:"",flat:"",size:"sm",loading:t(N)&&i.value===Number(n.key),onClick:V=>L(Number(n.key))},{default:e(()=>[a(k,null,{default:e(()=>[b("Editar resultados.")]),_:1})]),_:2},1032,["loading","onClick"]),n.row.estado===0?(l(),d(C,{key:0,color:"info",icon:"fas fa-check-double",round:"",flat:"",size:"sm",loading:t(S)&&i.value===Number(n.key),onClick:V=>T(Number(n.key))},{default:e(()=>[a(k,null,{default:e(()=>[b("Confirmar registro.")]),_:1})]),_:2},1032,["loading","onClick"])):u("",!0)]),_:1},8,["ordens"])):u("",!0)]),_:1}),a(y,{name:"edit-examens"},{default:e(()=>[t(s)?(l(),d(B,{key:0,icon:"fas fa-file-signature",label:"Datos de la orden."},{default:e(()=>[a(p,{class:"my-card"},{default:e(()=>[a(h,null,{default:e(()=>[a(G,{orden:t(s)},null,8,["orden"])]),_:1})]),_:1})]),_:1})):u("",!0),t(s)?(l(),d(B,{key:1,icon:"fas fa-vials",label:"Registrar resultados.",caption:"Editar / Crear","default-opened":""},{default:e(()=>[a(p,{class:"my-card"},{default:e(()=>[a(h,null,{default:e(()=>[a(M,{orden:t(s),onCancel:g,onSubmit:g},null,8,["orden"])]),_:1})]),_:1})]),_:1})):u("",!0)]),_:1})]),_:1},8,["modelValue"])])]))}});export{le as default};
