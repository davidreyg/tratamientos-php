import{au as k,a_ as $,d as w,h as g,j as f,v as r,G as h,ay as v,x as s,a4 as y,az as p,K as _,b3 as x,a$ as b,b0 as E,e as A,u,B as N,aE as O}from"./index.80fb9679.js";import{_ as D}from"./BaseTable.7281b0a1.js";import{E as C}from"./EmpleadoApi.b1521251.js";import{Q as L}from"./QueryTypes.707bd378.js";import"./QTable.b828e675.js";import"./QSelect.6ee785ba.js";import"./rtl.b51694b1.js";class P{static async run(a){try{await C.delete(a)}catch(o){throw o}}}class Q{static async run(a){try{return(await C.fetchAll({fetchAll:!0,...a})).data()}catch(o){throw o}}}function S(){return k(t=>P.run(t))}function T(t){const a=async()=>await Q.run(t.value),{data:o,isLoading:l,isSuccess:c,isError:d,isFetching:e,refetch:i}=$([L.EMPLEADOS_ALL,t==null?void 0:t.value],a,{keepPreviousData:!0});return{data:o,isLoading:l,isSuccess:c,isError:d,isFetching:e,refetch:i}}const F=w({__name:"EmpleadoTable",props:{loading:{type:Boolean,required:!1,default:!1},data:{type:Array,required:!0},serverPagination:{type:Object,default:void 0}},emits:["destroyOne","edit","request"],setup(t,{emit:a}){const o=a,l=[{name:"nombres",align:"left",label:"Nombres",field:e=>`${e.nombres} ${e.apellido_paterno} ${e.apellido_materno}`,sortable:!0},{name:"establecimientos:establecimiento_id|establecimientos.nombre",align:"center",label:"Establecimiento",sortable:!0,field:e=>e.establecimiento.data.nombre},{name:"cargos:cargo_id|cargos.nombre",align:"center",label:"Cargo",sortable:!0,field:e=>e.cargo.data.nombre},{name:"numero_documento",align:"center",label:"N\xB0 de Documento",sortable:!1,field:e=>e.numero_documento},{name:"actions",align:"right",label:"",field:"actions"}],{mutateAsync:c}=S(),d=e=>{b.fire({title:"\xBFEst\xE1 seguro de eliminar este registro?",text:"No podra deshacer los cambios!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:async()=>{await c(Number(e),{onSuccess:async()=>{o("destroyOne",e)},onError:()=>{b.hideLoading()}})},allowOutsideClick:()=>!b.isLoading()})};return(e,i)=>(g(),f(D,{columns:l,data:t.data,loading:t.loading,"row-key":"id","show-grid-toggle":!1,"server-pagination":t.serverPagination,onRequest:i[0]||(i[0]=n=>e.$emit("request",n))},{actions:r(({key:n})=>[h((g(),f(v,{clickable:"",onClick:m=>e.$emit("edit",n)},{default:r(()=>[s(p,{avatar:""},{default:r(()=>[s(y,{name:"fas fa-pen-to-square",color:"warning"})]),_:1}),s(p,null,{default:r(()=>[_("Editar")]),_:1})]),_:2},1032,["onClick"])),[[E]]),s(x),h((g(),f(v,{clickable:"",onClick:m=>d(n)},{default:r(()=>[s(p,{avatar:""},{default:r(()=>[s(y,{name:"fas fa-trash-can",color:"negative"})]),_:1}),s(p,null,{default:r(()=>[_("Eliminar")]),_:1})]),_:2},1032,["onClick"])),[[E]])]),_:1},8,["data","loading","server-pagination"]))}}),K=w({__name:"EmpleadoListPage",setup(t){const a=A({page:1}),{data:o,isFetching:l,isSuccess:c,refetch:d}=T(a),e=()=>{O.success("Registro eliminado correctamente."),d.value()},i=n=>{a.value.page=n.pagination.page,a.value.limit=n.pagination.rowsPerPage,a.value.search=n.filter,a.value.orderBy=n.pagination.sortBy,a.value.sortedBy=n.pagination.descending?"desc":"asc"};return(n,m)=>u(c)&&u(o)?(g(),f(F,{key:0,data:u(o).data,loading:u(l),"server-pagination":u(o).meta.pagination,onEdit:m[0]||(m[0]=B=>n.$router.push({name:"empleados.edit",params:{id:B}})),onDestroyOne:e,onRequest:i},null,8,["data","loading","server-pagination"])):N("",!0)}});export{K as default};
