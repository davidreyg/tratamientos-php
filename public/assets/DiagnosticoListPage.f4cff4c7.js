import{W as D,aR as y,aH as B,aI as C,Y as _,o as f,e as p,w as u,x as b,a7 as w,a5 as m,Q as x,a8 as h,f as O,aG as g,aF as N,aS as A,r as L,a2 as d,au as S,ag as k}from"./index.cb32cbc7.js";import{_ as F}from"./BaseTable.4c4c3f7b.js";function P(){return D(a=>y.delete(a))}function Q(a){const t=async()=>(await y.fetchAll(a.value)).data(),{data:o,isLoading:s,isSuccess:r,isError:c,isFetching:l,refetch:e}=B([C.DIAGNOSTICO_ALL,a==null?void 0:a.value],t);return{data:o,isLoading:s,isSuccess:r,isError:c,isFetching:l,refetch:e}}const E=_({__name:"DiagnosticosDataTable",props:{loading:{type:Boolean,required:!1,default:!1},data:{type:Array,required:!0},serverPagination:{type:Object,default:void 0}},emits:["destroyOne","request"],setup(a,{emit:t}){const o=t,{formatDate:s}=A(),r=[{name:"fecha",align:"left",label:"Fecha",field:"created_at",format:e=>s(e)},{name:"paciente",align:"center",label:"Paciente",field:e=>e.paciente.data.nombres+" "+e.paciente.data.apellido_paterno+" "+e.paciente.data.apellido_materno},{name:"dni",align:"center",label:"N\xB0 Documento",field:e=>e.paciente.data.numero_documento},{name:"Descripcion",align:"center",label:"Descripcion",field:"observaciones"},{name:"actions",align:"right",label:"Acciones",field:"actions"}],{mutateAsync:c}=P(),l=e=>{g.fire({title:"\xBFEst\xE1 seguro de eliminar este registro?",text:"No podra deshacer los cambios!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:async()=>{await c(Number(e),{onSuccess:async()=>{o("destroyOne",e)},onError:()=>{g.hideLoading()}})},allowOutsideClick:()=>!g.isLoading()})};return(e,n)=>(f(),p(F,{columns:r,data:a.data,loading:a.loading,"row-key":"id","show-grid-toggle":!1,"server-pagination":a.serverPagination,onRequest:n[0]||(n[0]=i=>e.$emit("request",i))},{actions:u(({key:i})=>[b((f(),p(w,{clickable:"",onClick:v=>l(i)},{default:u(()=>[m(h,{avatar:""},{default:u(()=>[m(x,{name:"fas fa-trash-can",color:"negative"})]),_:1}),m(h,null,{default:u(()=>[O("Eliminar")]),_:1})]),_:2},1032,["onClick"])),[[N]])]),_:1},8,["data","loading","server-pagination"]))}}),R=_({__name:"DiagnosticoListPage",setup(a){const t=L({page:1}),{data:o,isFetching:s,isSuccess:r,refetch:c}=Q(t),l=()=>{k.success("Registro eliminado correctamente."),c.value()},e=n=>{t.value.page=n.pagination.page,t.value.limit=n.pagination.rowsPerPage,t.value.search=n.filter,t.value.orderBy=n.pagination.sortBy,t.value.sortedBy=n.pagination.descending?"desc":"asc"};return(n,i)=>d(r)&&d(o)?(f(),p(E,{key:0,data:d(o).data,loading:d(s),"server-pagination":d(o).meta.pagination,onEdit:i[0]||(i[0]=v=>n.$router.push({name:"empleados.edit",params:{id:v}})),onDestroyOne:l,onRequest:e},null,8,["data","loading","server-pagination"])):S("",!0)}});export{R as default};
