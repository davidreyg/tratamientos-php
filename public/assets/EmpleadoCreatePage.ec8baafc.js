import{u as V,a as b,Q as L,_ as P,b as I}from"./personaReniecQuery.97915ade.js";import{ah as R,d as h,c as m,ar as j,w as K,h as v,j as x,v as d,x as o,ap as O,u as _,K as U,B as z,y as G}from"./index.c50cd903.js";import{D as H,u as J}from"./useLuxonFormat.a1b67595.js";import{u as W,a as X}from"./establecimientoFetchAllQuery.ad0f2d88.js";import{E as Y}from"./EmpleadoApi.d63d483f.js";import{u as Z}from"./tipoDocumentoFetchAllQuery.9affb33a.js";import{u as ee,a as s,_ as oe}from"./BaseForm.a2fb25a2.js";import{c as ae,a as t,e as f}from"./index.esm.1f0c9726.js";import"./QSelect.5f1b5a7b.js";import"./rtl.b51694b1.js";import"./index.f408676f.js";import"./QueryTypes.707bd378.js";import"./TipoDocumentoApi.057d7bfa.js";class re{static async run(i){try{await Y.create(i)}catch(r){throw r}}}function le(){return R(c=>re.run(c))}const ne={class:"col-xs-12 col-sm-4"},se=h({__name:"EmpleadoCreateForm",emits:["submit","cancel"],setup(c,{emit:i}){const r=i,{data:u}=Z(),q=m(()=>u.value?u.value.map(e=>({label:e.nombre,value:e.id})):[]),{data:E}=W(),N=m(()=>E.value?E.value.map(e=>({label:e.nombre,value:e.id})):[]),{data:g}=X(),F=m(()=>g.value?g.value.map(e=>({label:e.nombre,value:e.id})):[]),y=m(()=>{const e=q.value.find(a=>a.value==Number(p.tipo_documento_id));return e?e.label==="DNI":!1}),$=ae().shape({nombres:t().trim().required().label("Nombres"),apellido_paterno:t().trim().required().label("Apellido Paterno"),apellido_materno:t().trim().required().label("Apellido Materno"),tipo_documento_id:t().required().label("Tipo de Documento"),direccion:t().trim().required().label("Direccion"),numero_documento:f().typeError("Debe ingresar un n\xFAmero").required().label("N\xFAmero de Documento"),fecha_nacimiento:t().trim().required().label("Fecha de Nacimiento"),telefono:f().typeError("Tel\xE9fono debe ser un numero").integer().positive().required().label("Tel\xE9fono"),edad:f().typeError("Edad debe ser un numero").integer().positive().required().label("Edad"),sexo:t().required().label("Sexo")}),{handleSubmit:C,setErrors:D,values:p,setFieldValue:l,resetForm:S}=ee({validationSchema:$}),{isLoading:A,mutate:T}=le(),k=C(async e=>{T(e,{onSuccess:()=>{j.success(),r("submit")},onError:a=>{D(a.data.errors)}})},e=>console.log(e)),{fetch:B,reniec:n,isLoading:M}=V(),Q=async()=>{if(await B(p.numero_documento),n.value){l("nombres",n.value.nombres),l("apellido_paterno",n.value.apellido_paterno),l("apellido_materno",n.value.apellido_materno),l("direccion",n.value.direccion),l("sexo",n.value.sexo==="1"?"Masculino":"Femenino");var e=n.value.fecha_nacimiento.split("/");const a=H.local(Number(e[2]),Number(e[1]),Number(e[0]));a.isValid&&l("fecha_nacimiento",a.toISODate())}else S()},{calcularEdad:w}=J();return K(()=>p.fecha_nacimiento,e=>{e&&l("edad",w(e))}),(e,a)=>(v(),x(oe,{loading:_(A),onSubmit:_(k),onCancel:a[0]||(a[0]=te=>e.$emit("cancel"))},{default:d(()=>[o(b,{options:q.value,name:"tipo_documento_id",class:"col-xs-12 col-sm-4",label:"Tipo de Documento",loading:!1,required:""},null,8,["options"]),o(s,{name:"numero_documento",label:"N\xB0 de Documento",class:"col-xs-12 col-sm-4",required:""},{after:d(()=>[y.value?(v(),x(O,{key:0,round:"",dense:"",icon:"search",color:"primary",loading:_(M),onClick:Q},{default:d(()=>[o(L,null,{default:d(()=>[U(" Buscar en RENIEC ")]),_:1})]),_:1},8,["loading"])):z("",!0)]),_:1}),o(b,{options:N.value,name:"establecimiento_id",class:"col-xs-12 col-sm-4",label:"Establecimiento",loading:!1,required:""},null,8,["options"]),o(b,{options:F.value,name:"cargo_id",class:"col-xs-12 col-sm-4",label:"Cargo",loading:!1,required:""},null,8,["options"]),o(s,{name:"nombres",label:"Nombres",class:"col-xs-12 col-sm-4",required:""}),o(s,{name:"apellido_paterno",label:"Apellido Paterno",class:"col-xs-12 col-sm-4",required:""}),o(s,{name:"apellido_materno",label:"Apellido Materno",class:"col-xs-12 col-sm-4",required:""}),G("div",ne,[o(P,{required:"",name:"fecha_nacimiento",label:"Fecha Nacimiento"})]),o(s,{name:"direccion",label:"Direcci\xF3n",class:"col-xs-12 col-sm-4",required:""}),o(s,{name:"telefono",label:"Tel\xE9fono",class:"col-xs-12 col-sm-4",required:""}),o(s,{name:"edad",label:"Edad",class:"col-xs-12 col-sm-4",required:""}),o(I,{required:"",options:[{label:"Masculino",value:"Masculino"},{label:"Femenino",value:"Femenino"}],name:"sexo",label:"Sexo",class:"col-xs-12 col-sm-8"})]),_:1},8,["loading","onSubmit"]))}}),ge=h({__name:"EmpleadoCreatePage",setup(c){return(i,r)=>(v(),x(se,{onSubmit:r[0]||(r[0]=u=>i.$router.back()),onCancel:r[1]||(r[1]=u=>i.$router.back())}))}});export{ge as default};
